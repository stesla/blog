<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Alieniloquent: Make SLIME load faster</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-reset.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-fonts.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-grids.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/simple-style.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/blog.css" />
</head>
<body>
 <div id="doc" class="yui-t4">
   <div id="hd" class="content">
     <h1 id="title"><a href="http://www.alieniloquent.com/">Alieniloquent</a></h1>
     <ul id="navigation">
       <li class="first"><a href="http://blog.alieniloquent.com">blog</a></li>
       <li><a href="http://github.com/stesla">code</a></li>
       <li><a href="http://www.alieniloquent.com/resume.pdf">resum&eacute;</a></li>
     </ul>
     <br/>
   </div>
   <div id="bd">
     <div id="yui-main">
       <div class="yui-b">
         <div class="post">
  <h3><a href="/2007/12/29/make-slime-load-faster.html" title="Permalink for this post">Make SLIME load faster</a></h3>
  <p class="date">December 29th, 2007</p>
  <div class="entry"><p>I have joined up with some of the guys from <a href='http://www.blainebuxton.com/odynug/'>ODYNUG</a> who have started meeting for breakfast and learning <a href='http://en.wikipedia.org/wiki/Common_Lisp'>Common Lisp</a> together. We are all using some version of Emacs, <a href='http://common-lisp.net/project/slime/'>SLIME</a>, and <a href='http://sbcl.sourceforge.net/'>SBCL</a>.</p>

<p><a href='http://blainebuxton.com'>Blaine</a> shared a cool way to make SLIME load much faster by taking advantage of the fact that Lisp uses images like Smalltalk (or more accurately, Smalltalk uses images like Lisp). He posted it for the group to see, but I wanted to post it here for my readers.</p>

<p>SBCL allows you to specify an image, or as they call it a core, by passing the <code>--core</code> option along with (as far as I can tell) an absolute path to the core file (well, at least it doesn&#8217;t know that <code>~</code> means <code>$HOME</code>). It, of course, also provides a way to create these core files, so you can load a bunch of stuff in, and then save a core file that has all of that already loaded.</p>

<p>So first, go into your SLIME directory and copy <code>swank-loader.lisp</code> to <code>swank-
loader-original.lisp</code>. Then make <code>swank-loader.lisp</code> look like this (changing <code>slime-dir</code> to be wherever your SLIME is, of course):</p>
<div class='highlight'><pre><code class='text'>(if (not (find-package &#39;swank-loader))
    ;; Edit SLIME-DIR to be where you have SLIME installed.
    (let ((slime-dir (merge-pathnames &quot;.elisp/slime/&quot; (user-homedir-pathname))))
      (load (merge-pathnames &quot;swank-loader-original&quot; slime-dir))))
</code></pre>
</div>
<p>Then, make a file called <code>bootstrap.lisp</code> with the following content:</p>
<div class='highlight'><pre><code class='text'>;; Load Swank
(load (merge-pathnames &quot;.elisp/slime/swank-loader&quot; (user-homedir-pathname)))

;; Save image
(sb-ext:save-lisp-and-die &quot;sbcl-with-slime.core&quot;)
</code></pre>
</div>
<p>And run this command:</p>
<div class='highlight'><pre><code class='text'>$ sbcl --load bootstrap.lisp
</code></pre>
</div>
<p>Then copy <code>sbcl-with-slime.core</code> somewhere safe, I put mine in with my slime code to keep it all together. Then you just have to add the following to your <code>.emacs</code>:</p>
<div class='highlight'><pre><code class='text'>(let* ((slime-dir (concat elisp-dir &quot;/slime&quot;))
       (core-file (concat slime-dir &quot;/sbcl-with-slime.core&quot;)))
  (setq inferior-lisp-program (concat &quot;sbcl --core &quot; core-file)))
</code></pre>
</div>
<p>Then you can <code>M-x slime</code> and it will be super fast.</p></div>
  <p class="metadata alt">You may notice that I do not provide a space
    for comments. If you want to start a conversation, you can
    <a href="mailto:blog@alieniloquent.com">email me</a>, 
    <a href="http://twitter.com/stesla">tweet at me</a>, or post
    something on your own blog.</p>
</div>

       </div>
     </div>
     <div class="yui-b">
       <div class="yui-u sidebar">
         <h2 class="sectionheader first">Archives</h2>
         <ul>
           
           <li><a href="/2011/">2011</a></li>
           
           <li><a href="/2010/">2010</a></li>
           
           <li><a href="/2009/">2009</a></li>
           
           <li><a href="/2008/">2008</a></li>
           
           <li><a href="/2007/">2007</a></li>
           
           <li><a href="/2006/">2006</a></li>
           
           <li><a href="/2005/">2005</a></li>
           
         </ul>
       </div>
     </div>
   </div>
   <div id="ft">
     <p>Layout, design, graphics, photography and text all &copy; 2005-2010 Samuel Tesla unless otherwise noted.</p>
     <p>Portions of the site layout use Yahoo! YUI Reset, Fonts &amp; Grids.</p>
   </div>
 </div>

<!-- BEGIN GOOGLE ANALYTICS -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-12538528-2");
pageTracker._setDomainName(".alieniloquent.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- END GOOGLE ANALYTICS -->

</body>
</html>
