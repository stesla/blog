<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Alieniloquent: Subversion + Apache + Windows</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-reset.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-fonts.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-grids.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/simple-style.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/blog.css" />
</head>
<body>
 <div id="doc" class="yui-t4">
   <div id="hd" class="content">
     <h1 id="title"><a href="http://www.alieniloquent.com/">Alieniloquent</a></h1>
     <ul id="navigation">
       <li class="first"><a href="http://blog.alieniloquent.com">blog</a></li>
       <li><a href="http://github.com/stesla">code</a></li>
       <li><a href="http://www.alieniloquent.com/resume.pdf">resum&eacute;</a></li>
     </ul>
     <br/>
   </div>
   <div id="bd">
     <div id="yui-main">
       <div class="yui-b">
         <div class="post">
  <h3><a href="/2005/10/20/subversion-apache-windows.html" title="Permalink for this post">Subversion + Apache + Windows</a></h3>
  <p class="date">October 20th, 2005</p>
  <div class="entry"><p>I&#8217;ve always set up Subversion and Apache on Unix systems. Heck, aside from work, I generally don&#8217;t use Windows. However, at work, it&#8217;s all Windows on our production boxes. So, naturally, we needed our version control to run on a Windows box.</p>

<p>I started out reading Brian&#8217;s <a href='http://blog.briankohrs.com/2005/09/20/guide-to-installing-the-subverison-http-module-on-windows/'>guide</a> to installing everything. Now, I didn&#8217;t use his one-click installer, but I followed the rest. Notably, I believe the system account on our server didn&#8217;t pay attention to the path I had set system-wide, as it could not load the Subversion modules unless I gave it absolute paths for everything. But I got that working. It was interesting to note that when I had Apache installed, the Subversion installer actually offerred to install and configure the modules for me. I had Subversion access through HTTP.</p>

<p>Since we were going to be keeping our source code in this, I wanted to make sure it was secure. Only authorized people should be able to access the repository. I don&#8217;t want to administer a password database, and furthermore nobody wants to remember two passwords, so I wanted to hook into our Windows domain authentication. The way to do this is <a href='http://www.deadbeef.com/index.php/2004/03/29/mod_auth_sspi'>mod_auth_sspi</a>. I spent about thirty minutes tracking down that module, as apparently the original author no longer publishes it. Furthermore, I could only find the source.</p>

<p>Finding the source was only a third of the battle, though. Getting it built and installed each took another thirty each. The Makefile is not very generic. You have to edit lots of paths to get things to work, and it doesn&#8217;t even define <code>$(RC)</code> even though it uses it. But, I finally got it to compile. Then came the adventure of installing it. I copied the module to the right place and added the right line to the config. Apache won&#8217;t start. I run it by hand from the command line, and it tells me it can&#8217;t find the file, despite it being right there next to all the others it can find just fine. I spent most of thirty minutes googling, and finally realized that it could find <em>my</em> file just fine. It was a DLL that my module loaded it couldn&#8217;t find. Namely, <code>msvcr71.dll</code>. I copied that in, and everything worked hunky dory.</p>

<p>My last concern was backing up our repository. Currently we just do a disk backup of our VSS repository. I don&#8217;t think we&#8217;ve ever had to restore from one of those, and I&#8217;m not entirely sure it would work. But, I do know that straight disk copy out of an active Subversion is bad, since it&#8217;s database files. So, I go looking about how to back it up. There&#8217;s a script that comes in the source tree called <code>hot-backup.py</code>. I installed Python and tried to run it. No luck. It wasn&#8217;t written with Windows in mind. I had to spend most of an hour poking and prodding it. It turns out that <code>os.spawnl</code> doesn&#8217;t read from the path environment (on purpose) but <em>does not</em> need or want the path to the executable quoted, but <code>os.popen3</code> does read from the environment and <em>does</em> need and want the path to the executable quoted. Once I got that all figured out, I put it in the scheduler and hopefully it will run tonight during the wee hours backing up my nearly empty repository.</p>

<p>More soon about moving the source over. It&#8217;s very exciting.</p></div>
  <p class="metadata alt">You may notice that I do not provide a space
    for comments. If you want to start a conversation, you can
    <a href="mailto:blog@alieniloquent.com">email me</a>, 
    <a href="http://twitter.com/stesla">tweet at me</a>, or post
    something on your own blog.</p>
</div>

       </div>
     </div>
     <div class="yui-b">
       <div class="yui-u sidebar">
         <h2 class="sectionheader first">Archives</h2>
         <ul>
           
           <li><a href="/2011/">2011</a></li>
           
           <li><a href="/2010/">2010</a></li>
           
           <li><a href="/2009/">2009</a></li>
           
           <li><a href="/2008/">2008</a></li>
           
           <li><a href="/2007/">2007</a></li>
           
           <li><a href="/2006/">2006</a></li>
           
           <li><a href="/2005/">2005</a></li>
           
         </ul>
       </div>
     </div>
   </div>
   <div id="ft">
     <p>Layout, design, graphics, photography and text all &copy; 2005-2010 Samuel Tesla unless otherwise noted.</p>
     <p>Portions of the site layout use Yahoo! YUI Reset, Fonts &amp; Grids.</p>
   </div>
 </div>

<!-- BEGIN GOOGLE ANALYTICS -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-12538528-2");
pageTracker._setDomainName(".alieniloquent.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- END GOOGLE ANALYTICS -->

</body>
</html>
