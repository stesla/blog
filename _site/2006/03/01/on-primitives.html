<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>Alieniloquent: On Primitives</title>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-reset.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-fonts.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/yui-grids.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/simple-style.css"/>
  <link rel="stylesheet" type="text/css" href="/stylesheets/blog.css"/>
  <link href="http://blog.alieniloquent.com/feed" rel="alternate" title="main feed" type="application/rss+xml"/>
</head>
<body>
 <div id="doc" class="yui-t4">
   <div id="hd" class="content">
     <h1 id="title"><a href="http://www.alieniloquent.com/">Alieniloquent</a></h1>
     <ul id="navigation">
       <li class="first"><a href="http://blog.alieniloquent.com">blog</a></li>
       <li><a href="http://github.com/stesla">code</a></li>
       <li><a href="http://www.alieniloquent.com/resume.pdf">resum&eacute;</a></li>
     </ul>
     <br/>
   </div>
   <div id="bd">
     <div id="yui-main">
       <div class="yui-b">
         <div class="post">
  <h3><a href="/2006/03/01/on-primitives.html" title="Permalink for this post">On Primitives</a></h3>
  <p class="date">March 1st, 2006</p>
  <div class="entry"><p>Blaine has a <a href='http://www.blainebuxton.com/weblog/2006/02/string-how-i-loathe-thee.html'>post</a> about how strings are so frequently abused in object models. We heap extra meaning onto a string when we really should make a class. The reason we should make a new class is that each class represents a concept in our domain, and we can add behaviours and data to each class. You&#8217;ll be hard pressed to do that with a string. So, to stay agile it&#8217;s better to make new classes for new concepts.</p>

<p>In Delphi, there&#8217;s a similarly abused syntax trick. It looks like this:</p>
<div class='highlight'><pre><code class='delphi'><span class='k'>type</span> <span class='n'>TMyEnum</span> <span class='o'>=</span> <span class='p'>(</span><span class='n'>meOne</span><span class='o'>,</span> <span class='n'>meTwo</span><span class='o'>,</span> <span class='n'>meThree</span><span class='p'>)</span><span class='o'>;</span>
<span class='k'>const</span> <span class='n'>MyEnumStrings</span><span class='o'>:</span> <span class='k'>array</span><span class='p'>[</span><span class='n'>TMyEnum</span><span class='p'>]</span> <span class='k'>of</span> <span class='k'>string</span> <span class='o'>=</span> <span class='p'>(</span><span class='s'>&#39;First&#39;</span><span class='o'>,</span> <span class='s'>&#39;Second&#39;</span><span class='o'>,</span> <span class='s'>&#39;Third&#39;</span><span class='p'>)</span><span class='o'>;</span>
</code></pre>
</div>
<p>Then, wherever you want to get a string associated with one of the enum tokens, you can just index into that constant array <em>using the enum value</em>.</p>

<p>This trick isn&#8217;t limited to arrays of strings, either. You could have arrays of integers, doubles, characters, or even objects, and you can make as many of these arrays as possible. So if you have some setting and there&#8217;s ten values that change with that setting, then you could have the setting be an enumeration and have ten constant arrays indexed on that.</p>

<p>In a world of procedural programming, that&#8217;s a neat trick, and it can help a lot. But Delphi shed it&#8217;s procedural shackles years ago, and now it has the power of objects to help it out. Sadly, many programmers are tied to Delphi&#8217;s procedural roots, and can&#8217;t get away from this enumeration-indexed array trick.</p>

<p>What&#8217;s so bad about the trick? For starters, you&#8217;re making global data. Sure, it&#8217;s constant data, but it&#8217;s global, which makes finding where the data is coming from that much harder for somebody new to the code (or somebody reading it months after they wrote it). Secondly, in order to vary behavior based on the enumeration, you have to have gnarly conditionals that branch based on the type code. This makes methods longer and harder to understand and follow. Lastly, it makes the types more resistant to change, especially if they&#8217;re serialized as integers: any change in order will change the ordinal (integer) value of the same enumerated value.</p>

<p>What&#8217;s the alternative? Make a class. You can easily make a class that represents the type code, and you can make subclasses for each type. The class can have methods for each of the constant arrays and the subclasses can implement them to return the proper ordering. If there&#8217;s behavior specific to one type you can put it on this class hierarchy and polymorphically switch out behaviors, instead of making gnarly conditionals. Moreover, there&#8217;s no inherent ordering from one class to the next, so you can completely control how things are serialized and compared.</p>

<p>As Joshua Kerievsky says in his book <a href='http://www.amazon.com/gp/product/0321213351/'>Refactoring to Patterns</a>, so many developers have an obsession with using language primitives such as strings, integers, or enumerations. Whether that&#8217;s because they think that it&#8217;s too much work to make a class, or it&#8217;ll take too many CPU cycles, or it&#8217;ll eat up too much memory, it doesn&#8217;t matter. The obsession with primitives is unhealthy and it leads to spaghetti code that is hard to refactor.</p>

<p>We must resist the temptation and make supple, agile code. That means we must make classes.</p></div>
  <p class="metadata alt">You may notice that I do not provide a space
    for comments. If you want to start a conversation, you can
    <a href="mailto:blog@alieniloquent.com">email me</a>, 
    <a href="http://twitter.com/stesla">tweet at me</a>, or post
    something on your own blog.</p>
</div>

       </div>
     </div>
     <div class="yui-b">
       <div class="yui-u sidebar">
         <h2 class="sectionheader first">Archives</h2>
         <ul>
           
           <li><a href="/2011/">2011</a></li>
           
           <li><a href="/2010/">2010</a></li>
           
           <li><a href="/2009/">2009</a></li>
           
           <li><a href="/2008/">2008</a></li>
           
           <li><a href="/2007/">2007</a></li>
           
           <li><a href="/2006/">2006</a></li>
           
           <li><a href="/2005/">2005</a></li>
           
         </ul>
       </div>
     </div>
   </div>
   <div id="ft">
     <p>Layout, design, graphics, photography and text all &copy; 2005-2010 Samuel Tesla unless otherwise noted.</p>
     <p>Portions of the site layout use Yahoo! YUI Reset, Fonts &amp; Grids.</p>
   </div>
 </div>

<!-- BEGIN GOOGLE ANALYTICS -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-12538528-2");
pageTracker._setDomainName(".alieniloquent.com");
pageTracker._trackPageview();
} catch(err) {}</script>
<!-- END GOOGLE ANALYTICS -->

</body>
</html>
